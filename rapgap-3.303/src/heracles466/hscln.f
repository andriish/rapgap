CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        FUNCTION HSCLN(Z)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C       KOMPLEXER NATUERLICHER LOGARITHMUS MIT SCHNITT= NEG. REELLE ACHS
C-----------------------------------------------------------------------
C       20.07.83 UE 20.08.85
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        COMPLEX*16 HSCLN,Z
        DOUBLE PRECISION X,Y,R,PHI,HSSIGN
        EXTERNAL HSSIGN
C---->  HSSIGN(A,B)=|A|*SGN(B), NICHT DIE INTRINSIC FUNCTION VERWENDEN!
C       PI=3.1415926535897932384
        X=DREAL(Z)
        Y=DIMAG(Z)
        R=ABS(Z)
        IF (X)  10,20,30
20      PHI=HSSIGN(1.5707963267948966192D0,Y)
        GOTO 100
10      IF (Y .EQ. 0D0) GOTO 40
        PHI=DATAN(Y/X)+HSSIGN(3.1415926535897932384D0,Y)
        GOTO 100
40      PHI=3.1415926535897932384D0
        GOTO 100
30      PHI=DATAN(Y/X)
100     HSCLN=DCMPLX(DLOG(R),PHI)
        RETURN
        END
