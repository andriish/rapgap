C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
        FUNCTION HSFONE(Q2,RM,RN)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C       SKALARES EINSCHLEIFENINTEGRAL, DOPPELTLANG, 'REGULAERER ANTEIL'
C       F(Q2,RM,RN)=B0(Q2,RM,RN)-B0(0D0,RM,RN)  'SUBTRAHIERTES F'
C       Q2=QUADRAT DES DIE SCHLEIFE DURCHLAUFENDEN IMPULSES
C       RM,RN: MASSEN DER TEILCHEN AUF BEIDEN ARMEN
C       D O U B L E P R E C I S I O N
C-----------------------------------------------------------------------
C       19.10.83
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        COMPLEX*16 HSFONE
        DOUBLEPRECISION M,N,PI,A,S,T,B,C,D,Q2,RM,RN,U,V,W
        DATA PI/3.1415926535897932384626438D0/
        M=RM
        N=RN
505     IF (M .EQ. N ) GOTO 30
506     IF (N .EQ. 0.D0) GOTO 310
507     IF (M .EQ. 0.D0) GOTO 300
C---->  ALLGEMEINER FALL
510     IF (Q2 .NE. 0D0) GOTO 520
        B=0D0
        A=0D0
        GOTO 560
520     U=M*M+N*N
        V=M*M-N*N
        W=M*N
        S=M+N
        T=M-N
        C=DSQRT(DABS(S*S-Q2))
        D=DSQRT(DABS(T*T-Q2))
        B=1D0+(V/Q2-U/V)*DLOG(N/M)
540     IF (2D0*W .LE. DABS(Q2-U)) GOTO 550
        B=B-2D0*C*D/Q2*DATAN(D/C)
        A=0D0
        GOTO 560
550     A=C*D/Q2
        B=B-DSIGN(1D0,Q2-U)*A*DLOG((C+D)*(C+D)/(4D0*W))
        A=PI*A
        IF (Q2 .GE. U) GOTO 560
        A=0D0
560     CONTINUE
570     HSFONE=DCMPLX(B,A)
        RETURN
C---->  GLEICHE MASSEN
30      IF (Q2 .NE. 0D0) GOTO 40
        B=0D0
        A=0D0
        GOTO 560
40      U=4D0*M*M
        IF (DABS(Q2).LT.U/1D4) THEN
          B=Q2/6D0/M/M
          A=0D0
          GOTO 560
        ENDIF
        V=DSQRT(DABS(1D0-U/Q2))
        IF ((Q2 .GE. 0D0) .AND. (Q2 .LT. U)) GOTO 50
        B=2D0-V*DLOG((V+1D0)*(V+1D0)/U*DABS(Q2))
        A=PI*V
        IF (Q2 .GE. U) GOTO 560
        A=0D0
        GOTO 560
50      B=2D0-2D0*V*DATAN(1D0/V)
        A=0D0
        GOTO 560
C---->  EINE MASSE NULL
300     M=N
310     IF (Q2 .NE. M*M) GOTO 320
        A=0D0
        B=1D0
        GOTO 560
320     B=1D0
        IF(Q2 .EQ. 0D0) B=0D0
        A=B*(1D0-M*M/(Q2+(1D0-B)))
        B=B-A*DLOG(DABS(1D0-Q2/M/M))
        A=PI*A
        IF (Q2 .GT. M*M) GOTO 560
        A=0D0
        GOTO 560
        END
